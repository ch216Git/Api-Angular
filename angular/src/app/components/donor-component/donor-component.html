<!-- ---------------------------- -->
<!-- סינון וחיפוש תורמים -->
<!-- ---------------------------- -->
<div *ngIf="cuurentRoute === '/donor'" class="donor-list" style="direction: rtl">
  <div class="search-panel">
    <!-- <input
      [value]="nameSignal()"
      (input)="nameSignal.set($event.target.value)"
      placeholder="חפש לפי תורם"
      pInputText
    /> -->
    <input [value]="nameSignal()" (input)="nameSignal.set($event.target.value)" placeholder="חפש לפי תורם" pInputText />


    <select (change)="onChange($event)">
      <option value="sortByName">שם</option>
      <option value="sortByEmail">מייל</option>
      <option value="sortByGiftName">שם מתנה</option>
    </select>

    <!-- <button (click)="runAction()">חפש</button> -->
  </div>

  <!-- רשימת תורמים -->
  <div *ngFor="let donor of allDonorWithGift()" class="donor-row">
    <!-- פרטי תורם -->
    <div class="donor-info">
      <div class="donor-name" [routerLink]="['/donor', donor.id]">{{ donor.name }}</div>
      <div class="donor-meta">
        <span>{{ donor.email }}</span>
        <span>{{ donor.phone }}</span>
      </div>
    </div>

    <!-- פעולות -->
    <div class="donor-actions">
      <!-- עריכה -->
      <i class="pi pi-pencil action-icon edit" (click)="editDonor(donor)" title="עריכה"></i>

      <p-dialog header="עדכון תורם" [modal]="true" [(visible)]="visible"
        [style]="{ width: '28rem', borderRadius: '12px' }">
        <div class="dialog-content">
          <div class="form-row">
            <label for="username">שם</label>
            <input pInputText id="username" [(ngModel)]="selectedDonor.name" autocomplete="off" />
          </div>

          <div class="form-row">
            <label for="email">מייל</label>
            <input pInputText id="email" [(ngModel)]="selectedDonor.email" autocomplete="off" />
          </div>

          <div class="form-row">
            <label for="phone">מספר פלאפון</label>
            <input pInputText id="phone" [(ngModel)]="selectedDonor.phone" autocomplete="off" />
          </div>

          <div class="dialog-actions">
            <p-button label="ביטול" severity="secondary" (click)="visible = false"></p-button>
            <p-button label="שמור" (click)="saveDonor(selectedDonor.id)"></p-button>
          </div>
        </div>
      </p-dialog>

      <!-- מחיקה -->
      <i *ngIf="donor.gifts?.length === 0" class="pi pi-trash action-icon delete" (click)="deleteDonor(donor.id)"
        title="מחיקה"></i>
    </div>
  </div>
</div>

<!-- ---------------------------- -->
<!-- פרטי תורם ספציפי + מתנות -->
<!-- ---------------------------- -->
<div *ngIf="cuurentRoute.startsWith('/donor/') && cuurentRoute.length > '/donor/'.length">
  <div class="donor-info-panel">
    <h2>{{ donorById?.name }}</h2>
    <p><strong>מייל:</strong> {{ donorById?.email }}</p>
    <p><strong>טלפון:</strong> {{ donorById?.phone }}</p>
  </div>

  <div class="donor-gifts-panel">
    <h3>מתנות:</h3>
    <div class="gifts-grid">
      <div *ngFor="let gift of donorById?.gifts" class="gift-card">
        <img [src]="gift.image" alt="{{ gift.name }}" class="gift-image" />
        <p class="gift-name">{{ gift.name }}</p>
      </div>
    </div>
  </div>
</div>